/**
 * 
 */
package com.eoulu.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.List;

import com.eoulu.entity.MapParameterDO;
import com.eoulu.util.DataBaseUtil;

/**
 * @author mengdi
 *
 * 
 */
public class ParameterDao {

	private static DataBaseUtil db = new DataBaseUtil();
	
	/**
	 * 晶圆参数添加
	 * @param conn
	 * @param list
	 * @return
	 */
	public static String insertParameter(Connection conn,List<Object[]> list){
		String sql = "insert into dm_wafer_parameter (wafer_id,parameter_name,parameter_unit,parameter_column,upper_limit,lower_limit) values (?,?,?,?,?,?)";
		PreparedStatement ps;
		String flag = "success";
		try {
			ps = conn.prepareStatement(sql);
			if(list!=null){
				int interval = 10000;
				Object[] params = null;
				for(int i=0,size=list.size();i<size;i++){
					params = list.get(i);
					for(int j=0,length=params.length;j<length;j++){
						ps.setObject(j+1, params[j]);
					}
					ps.addBatch();
					if((i+1)%interval==0){
						ps.executeBatch();
					}
				}
				if(list.size()%interval>0){
					ps.executeBatch();
				}
			}
		} catch (SQLException e) {
			e.printStackTrace();
			flag = "晶圆参数添加失败！";
		}
		return flag;
		
	}
	
	public String insertMapParameter(Connection conn ,MapParameterDO map){
		String sql = "insert into dm_wafer_map_parameter (diameter,cutting_edge_length,die_x_max,die_y_max,direction_x,direction_y,set_coor_x,set_coor_y,set_coor_die_x,set_coor_die_y,stand_coor_die_x,stand_coor_die_y,wafer_id) value (?,?,?,?,?,?,?,?,?,?,?,?,?)";
		PreparedStatement ps;
		String flag = "success";
		try {
			ps = conn.prepareStatement(sql);
			ps.setObject(1, map.getDiameter());
			ps.setObject(2, map.getCuttingEdgeLength());
			ps.setObject(3, map.getDieXMax());
			ps.setObject(4, map.getDieYMax());
			ps.setObject(5, map.getDirectionX());
			ps.setObject(6, map.getDirectionY());
			ps.setObject(7, map.getSetCoorX());
			ps.setObject(8, map.getSetCoorY());
			ps.setObject(9, map.getSetCoorDieX());
			ps.setObject(10, map.getSetCoorDieY());
			ps.setObject(11, map.getStandCoorDieX());
			ps.setObject(12, map.getSetCoorDieY());
			ps.setObject(13, map.getWaferId());
			if(ps.executeUpdate()<1){
				flag = "晶圆的Map参数添加失败！";
			}
			
		} catch (SQLException e) {
			e.printStackTrace();
			flag = "晶圆的Map参数添加失败！";
		}
		
		return flag;
	}
	
	
}
