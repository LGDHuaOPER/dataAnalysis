function smithChart(e){var t=e.dom,l=e.titleOneArr,s=e.legendNameOneArr,D=e.allDataArr,i=e.Type,O=e.msgdom,a=e.lineColorArray,V=e.msgFun,o=e.msgInitFun,Y=e.GHzFlag,_=e.HzLv||1e7,j=e.chartType||"Smith";t.innerHTML="",t.innerHTML='<div class="picName" style="position: absolute;"> </div><div class="value" style="position:absolute;z-index:1"></div> <div class="pointValue" style="position:absolute;z-index:1"></div><div class="line1" style="position:absolute;z-index:1"></div> <div class="line2" style="position:absolute;z-index:1"></div><canvas class="canvas" style="position: absolute;"></canvas><div class="legend" style="position: absolute;display:none;"></div>';var J=t.getElementsByClassName("picName")[0],K=t.getElementsByClassName("legend")[0],r=l,Q=s,R=D;J.innerHTML=r[0],J.style.cssText="text-align: center;font-size: 20px;font-weight: bold;font-family: 宋体;display:none;";var U=t.getElementsByClassName("value")[0],Z=t.getElementsByClassName("pointValue")[0],$=t.getElementsByClassName("line1")[0],ee=t.getElementsByClassName("line2")[0],te=t.getElementsByClassName("canvas")[0];te.setAttribute("width",t.offsetWidth),te.setAttribute("height",t.offsetHeight);var le=0,se=te.width,ie=te.height,ae=te.getContext("2d");function n(e,t,l,s,i){this.type=e,this.axis=t,this.valueType=l,this.axisPointer=s,this.color=i}if(n.prototype.type="SmithPlot",n.prototype.plot=function(){this.type;var f=this.valueType,m=le,e=this.axisPointer,b=this.color;J.style.height=le+"px",J.style.lineHeight=le+"px",J.style.color=b[7],J.style.width=te.width+"px",K.style.top=ie<se?1.1*ie+"px":1.05*se+le+"px";var t,l,s,i,a,o,r,u,P,n,d,y,x,h=[],p=[],g=[],v=[],c=[],M=[],k=[],T=[],C=[],H=[];if("Smith"==j){for(h=[.2,.4,.8,1,1.5,2,3,4,5,10,50],n=l=0;n<h.length;n++)p[n]=1/(1+h[n]),g[n]=h[n]/(1+h[n]);for(i=1,d=0;d<h.length;d++)c[d]=1/h[d],M[d]=1/h[d];for(o=1,y=0;y<h.length;y++)T[y]=-1/h[y],C[y]=1/h[y];r=1,P=u=0,x=Math.min(se,ie)/2}else"Polar"==j?h=[.02,.04,.06,.08,.1,.12,.14]:"Polar"==j&&(h=[5,10,15,20]);P=(u=ie<se?(u-r)*x+2*x+Math.abs(se-ie)/2:(u-r)*x+2*x,(P-r)*x+2*x);var w=r*x;for(ae.beginPath(),ae.arc(u,P,w,0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke(),ae.font="6px",ae.strokeText(r-1,u-w,P),ae.closePath(),ae.beginPath(),ae.arc(u,P,w,0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke(),ae.clip(),ae.closePath(),n=0;n<h.length;n++)t=(g[n]=ie<se?(g[n]-r)*x+2*x+Math.abs(se-ie)/2:(g[n]-r)*x+2*x,(l-r)*x+2*x),v[n]=p[n]*x,ae.beginPath(),ae.arc(g[n],t,v[n],0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke(),ae.font="6px",ae.strokeText(h[n],g[n]-v[n],t);for(d=0;d<h.length;d++){M[d]=(s=ie<se?(i-r)*x+2*x+Math.abs(se-ie)/2:(i-r)*x+2*x,(c[d]-r)*x+2*x),k[d]=c[d]*x,ae.beginPath(),ae.arc(s,M[d],k[d],0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke();var L=g[d]-v[d]+.2*x;L<=s-k[d]&&(L=s-k[d]);var N=-Math.sqrt(k[d]*k[d]-(L-s)*(L-s))+M[d];ae.font="6px",ae.strokeText(-h[d],L,N),ae.closePath()}for(y=0;y<h.length;y++){C[y]=(a=ie<se?(o-r)*x+2*x+Math.abs(se-ie)/2:(o-r)*x+2*x,(T[y]-r)*x+2*x),H[y]=Math.abs(T[y])*x,ae.beginPath(),ae.arc(a,C[y],H[y],0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke();var F=g[y]-v[y]+.2*x;F<=a-H[y]&&(F=a-H[y]);var S=Math.sqrt(H[y]*H[y]-(F-a)*(F-a))+C[y];ae.font="6px",ae.strokeText(h[y],F,S),ae.closePath()}1==this.axis&&(ae.beginPath(),ae.moveTo(0,P),ae.lineTo(se,P),ae.strokeStyle=b[1],ae.stroke(),ae.closePath(),ae.beginPath(),ae.moveTo(u,0),ae.lineTo(u,ie),ae.strokeStyle=b[1],ae.stroke(),ae.closePath());var E=R.length;if(K.style.left=se/2-25*E+"px",0<E){var I=new Array(E);K.innerHTML="";for(var z=0;z<E;z++){I[z]=new Array(R[z].length);for(var B=0;B<I[z].length;B++){var q=u+parseFloat(R[z][B][1])*x,A=P-parseFloat(R[z][B][2])*x;I[z][B]=[q,A]}for(var X=0;X<I[z].length-1;X++)ae.beginPath(),ae.lineWidth=2,ae.moveTo(I[z][X][0],I[z][X][1]),ae.lineTo(I[z][X+1][0],I[z][X+1][1]),ae.strokeStyle=b[2][z],ae.stroke(),ae.closePath();var G=document.createElement("div");G.style.cssText="float:left;width:20px;height:2px;margin:10px 5px;",G.style.backgroundColor=b[2][z];var W=document.createElement("div");W.style.float="left",W.style.color=b[6],W.innerHTML=Q[z],K.appendChild(G),K.appendChild(W)}}1==e?te.addEventListener("mousemove",function(e,t){$.style.display="none",ee.style.display="none",U.style.display="none",Z.style.display="none";var l=oe(e);if(ae.beginPath(),ae.arc(u,P,w,0,2*Math.PI),ae.fillStyle="rgba(0, 0, 0, 0)",ae.fill(),ae.closePath(),ae.isPointInPath(l.x,l.y)){q=(l.x-u)/x,A=(P-l.y)/x,$.style.display="",ee.style.display="",U.style.display="",U.innerHTML='<div style="height: 20px;margin-top: -25px;margin-left: 10px;">'+q.toFixed(3)+","+A.toFixed(3)+"</div>",$.innerHTML='<div  style="height: 1px;background-color: rgba(0, 0, 0, 0);border-top: 1px dashed black ;"></div>',ee.innerHTML='<div  style="width: 1px;background-color: rgba(0, 0, 0, 0);border-left: 1px dashed black ;"></div>';var s=$.childNodes[0],i=ee.childNodes[0],a=2*Math.sqrt(w*w-(l.y-P)*(l.y-P)),o=2*Math.sqrt(w*w-(l.x-u)*(l.x-u)),r=l.x-(u-Math.sqrt(w*w-(l.y-P)*(l.y-P))),n=l.y-(P-Math.sqrt(w*w-(l.x-u)*(l.x-u)));if(U.style.left=l.x+"px",U.style.top=l.y+m+"px",$.style.left=l.x+"px",$.style.top=l.y+m+"px",ee.style.left=l.x+"px",ee.style.top=l.y+m+"px",s.style.width=a+"px",i.style.height=o+"px",s.style.marginLeft=-r+"px",i.style.marginTop=-n+"px","point"==f)for(var d=0;d<E;d++)for(var y=0;y<I[d].length;y++)if(ae.beginPath(),ae.arc(I[d][y][0],I[d][y][1],2,0,2*Math.PI),ae.fillStyle="rgba(0, 0, 0, 0)",ae.fill(),ae.closePath(),ae.isPointInPath(l.x,l.y)){Z.style.display="",Z.innerHTML='<div id="drawPoint" style="width: 8px;height:8px;border-radius: 50%;margin-left: -4px;margin-top: -4px;"></div><div id="valueContent" style="margin: 5px;"><div style="margin: 2px 5px">x:'+[R[d][y][1]]+'</div><div style="margin: 2px 5px">y:'+[R[d][y][2]]+"</div></div>";var h=document.getElementById("drawPoint"),p=document.getElementById("valueContent");h.style.color=b[3],h.style.backgroundColor=b[4][d],p.style.color=b[3],p.style.backgroundColor=b[5],Z.style.left=I[d][y][0]+"px",Z.style.top=I[d][y][1]+m+"px"}}},!1):te.addEventListener("mousemove",function(e,t){$.style.display="none",ee.style.display="none",U.style.display="none",Z.style.display="none";for(var l=oe(e),s=0;s<E;s++)for(var i=0;i<I[s].length;i++)if(ae.beginPath(),ae.arc(I[s][i][0],I[s][i][1],2,0,2*Math.PI),ae.fillStyle="rgba(0, 0, 0, 0)",ae.fill(),ae.closePath(),ae.isPointInPath(l.x,l.y))if("point"==f){Z.style.display="",Z.innerHTML='<div  style="width: 8px;height:8px;border-radius: 50%;margin-left: -4px;margin-top: -4px;"></div><div  style="margin: 10px;border-radius: 5px;"><div style="margin: 2px 5px">x:'+R[s][i][1]+'</div><div style="margin: 2px 5px">y:'+R[s][i][2]+"</div></div>";var a=Z.childNodes[0],o=Z.childNodes[1];a.style.color=b[3],a.style.backgroundColor=b[4][s],o.style.color=b[3],o.style.backgroundColor=b[5],Z.style.left=I[s][i][0]+"px",Z.style.top=I[s][i][1]+m+"px"}else if("cross"==f){$.style.display="",ee.style.display="",U.style.display="",U.innerHTML='<div style="height: 20px;">'+R[s][i][1]+","+R[s][i][2]+"</div>",$.innerHTML='<div   style="height: 1px;background-color: rgba(0, 0, 0, 0);border-top: 1px dashed black ;"></div>',ee.innerHTML='<div  style="width: 1px;background-color: rgba(0, 0, 0, 0);border-left: 1px dashed black ;"></div>';var r=$.childNodes[0],n=ee.childNodes[0],d=2*Math.sqrt(w*w-(I[s][i][1]-P)*(I[s][i][1]-P)),y=2*Math.sqrt(w*w-(I[s][i][0]-u)*(I[s][i][0]-u)),h=I[s][i][0]-(u-Math.sqrt(w*w-(I[s][i][1]-P)*(I[s][i][1]-P))),p=I[s][i][1]-(P-Math.sqrt(w*w-(I[s][i][0]-u)*(I[s][i][0]-u)));if(U.style.left=I[s][i][0]+"px",U.style.top=I[s][i][1]+m+"px",$.style.left=I[s][i][0]+"px",$.style.top=I[s][i][1]+m+"px",ee.style.left=I[s][i][0]+"px",ee.style.top=I[s][i][1]+m+"px",r.style.width=d+"px",n.style.height=y+"px",r.style.marginLeft=-h+"px",n.style.marginTop=-p+"px",O&&D.length){var x=R[s][i][0]/_;!0===Y&&(x=R[s][i][0]);var g="("+R[s][i][1].toFixed(2)+","+R[s][i][2].toFixed(2)+"),"+x.toFixed(2)+"GHz";if(V){var v=R[s][0][0]/_;!0===Y&&(v=R[s][0][0]);var c="("+R[s][0][1].toFixed(2)+","+R[s][0][2].toFixed(2)+"),"+v.toFixed(2)+"GHz";V(g,s,c)}else O.getElementsByClassName("Smith_Msg2")[0].innerText=g}}},!1)},O&&D.length){var d=R[0][0][0]/_;!0===Y&&(d=R[0][0][0]);var y="("+R[0][0][1].toFixed(2)+","+R[0][0][2].toFixed(2)+"),"+d.toFixed(2)+"GHz";o?o(y):O.getElementsByClassName("Smith_Msg2")[0].innerText=y}function oe(e){var t,l;return e.layerX||0==e.layerX?(t=e.layerX,l=e.layerY):(e.offsetX||0==e.offsetX)&&(t=e.offsetX,l=e.offsetY),{x:t,y:l}}n.prototype.onresize=function(){te.setAttribute("width",t.offsetWidth),te.setAttribute("height",t.offsetHeight-20),se=te.width,ie=te.height,le=0,h.plot()};var h=new n(i,!1,"cross",!1,["grey","black",a=a||["#1baee1","red"],"white",["#1baee1","red"],"rgba(128, 128, 128, 0.75)","grey","#028BCD"]);return h.onresize(),h}