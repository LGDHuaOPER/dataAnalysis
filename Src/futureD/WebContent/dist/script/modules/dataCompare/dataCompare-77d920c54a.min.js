var dataCompareSwalMixin=swal.mixin({confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger",buttonsStyling:!0,animation:!1,customClass:"animated zoomIn"}),dataCompareState=new Object;dataCompareState.paginationObj={normal:null,search:null},dataCompareState.pageObj={selector:null,pageOption:null,currentPage:null,pageCount:null,itemLength:null,data:null},dataCompareState.pageSearchObj={selector:"#pagelist",pageOption:{limit:10,count:0,curr:0,ellipsis:!0,pageShow:2,hash:!1,callback:function(a){dataCompareState.pageSearchObj.currentPage=a.curr,a.isFirst}},currentPage:null,pageCount:null,itemLength:null,data:null},dataCompareState.searchObj={hasSearch:!1,searchVal:null},dataCompareState.sellectObj={selectAll:!1,selectItem:[],selectSearchItem:[]},dataCompareState.stateObj={canClickParam:!1,curParam:null,curChartContainerNum:0,searchShow:!0,allChoose:!1,curWaferChange:!1},dataCompareState.chartTypeMap={good_rate:"spline",histogram:"column",boxlinediagram:"boxplot",CPK:"line",correlationgraph:"scatter"},dataCompareState.chartAjaxUrl={good_rate:"ShowYield",histogram:"Histogram",boxlinediagram:"Boxplot",CPK:"CPKServlet",correlationgraph:"scatter"},dataCompareState.curPageSelectAll={};var dataListDetailStore=Object.create(null);function draw_other_chart(e){console.log("draw_other_chart",e);var a,t,r,i=e.chartType,o=e.classify,n=e.IDParamObj,l=(e.paramsArr,e.data),d=e.errorArr,s=e.curWaferId,p=e.curWaferName,c=n.id,m=n.param;n.isAll;switch(o){case"histogram":var h=_.find(l,function(a,t){return _.toString(t)==_.toString(m)});a="直方图-"+m,t={categories:_.map(h.sectionX,function(a,t){var e=a.split("~");return _.forEach(e,function(a,t,e){var r;r=-1<a.indexOf("∞")?a:8<a.length?numeral(a).format("0.0000e+0"):a,e[t]=r}),_.join(e,"~")}),type:"linear",labels:{rotation:-45},plotLines:[{color:"#FF0000",width:2,value:.5},{color:"#FF0000",width:2,value:h.sectionX.length-1.5}]},r={title:{text:"百分数"}};var u,f=[];_.forEach(s,function(a){u=h.percentList[a],f.push({name:p[a],type:"column",data:_.map(u.percent,function(a){return parseFloat(a)})})}),v=f,console.log("histogram",v);break;case"boxlinediagram":for(var g=[],b=0;b<s.length;b++)g.push(p[s[b]]);a="箱线图-"+m,t={categories:g},r={title:{text:"值"}};h=_.find(l,function(a,t){return _.toString(t)==_.toString(m)});var v=[],C=[],y=[],S=[];for(var x in h)C.push(h[x].eigenValue),y=h[x].extreme,S=h[x].soft;v=[{name:"观测值",data:C,tooltip:{headerFormat:"<em>参数： {point.key}</em><br/>"}},{name:"极端异常值",color:Highcharts.getOptions().colors[0],type:"scatter",data:y,marker:{fillColor:"white",lineWidth:1,lineColor:Highcharts.getOptions().colors[0]},tooltip:{pointFormat:"极端异常值: {point.y}"}},{name:"温和异常值",color:Highcharts.getOptions().colors[1],type:"scatter",data:S,marker:{fillColor:"#ccc",lineWidth:1,lineColor:Highcharts.getOptions().colors[1]},tooltip:{pointFormat:"温和异常值: {point.y}"}}],console.log("boxlinediagram",v);break;case"CPK":for(var w=[],O=(h=_.find(l,function(a,t){return _.toString(t)==_.toString(m)}),0);O<e.curWaferId.length;O++){var j=_.find(h,function(a,t){return _.toString(t)==_.toString(e.curWaferId[O])}),D=e.curWaferName[e.curWaferId[O]];if(j.length<20){var N=_.find(d,function(a,t){return"CPK图"==a.chartCNName});_.isNil(N)?d.push({chartCNName:"CPK图",errorParamArr:[D+":"+m],classify:o,message:"参数数据不足"}):N.errorParamArr.push(D+":"+m)}else{var k={};k.name=p[e.curWaferId[O]],k.data=h[e.curWaferId[O]],w.push(k)}}a="CPK-"+m,t={categories:["一","二","三","四","五","六","七","八","九","十","十一","十二","十三","十四","十五","十六","十七","十八","十九","二十"]},r={title:{text:"values"}},v=w,console.log("CPK",v);break;case"correlationgraph":var P;for(var M in a="相关性图-"+m,p)if(m===p[M]){P=M;break}h=_.find(l,function(a,t){return _.toString(t)==_.toString(P)});t={title:{enabled:!0,text:$(".right_div .list-group-item-info").eq(0).data("iparam"),style:{fontSize:"16px",fontFamily:"arial",float:"top"}},lineWidth:1,startOnTick:!0,endOnTick:!0,showLastLabel:!0,labels:{useHTML:!0,formatter:function(){return"<a href=\"javascript:alert('hello')\">"+this.value+"</a>"}}},r={title:{text:$(".right_div .list-group-item-info").eq(1).data("iparam")}},(T={}).name=m;for(var A=[],I=0;I<h.X.length;I++){var F=[];F.push(parseFloat(h.X[I])),F.push(parseFloat(h.Y[I])),A.push(F)}T.data=A,v=[T],console.log("correlationgraph",v);break;default:var T;a="良品率图",(T={}).name=m,T.data=[];var L=[];h=_.find(l,function(a,t){return _.toString(t)==_.toString(m)});_.forEach(s,function(a){L.push(p[a]);var t=parseFloat(h[a]);T.data.push(t)}),t={categories:L},r={title:{text:"比率(%)"},min:0,max:100,tickInterval:10,labels:{formatter:function(){return this.value}}},v=[T],console.log("良品率图",v)}return dataCompareRenderChart({container:c,chart:{zoomType:"x",type:i},title:{text:a},subtitle:{text:null},xAxis:t,yAxis:r,series:_.cloneDeep(v),chartClassify:o,callback:null}),d}function draw_map_good_rate(a){var t=a.data,e=a.IDParamObj.wafer;if(_.isNil(e))return!1;var r=a.IDParamObj,i=$("#"+r.id),o=i.innerWidth();i.innerHeight(.8*o);var n="canvas_"+i.attr("id");i.append("<canvas id='"+n+"'></canvas>"),i.append("<div class='criterion_"+n+"'></div>");var l=_.find(t,function(a,t){return _.toString(t)==_.toString(e)}),d=[],s=_.find(l.waferList,function(a,t){return _.toString(a.parameter)==_.toString(r.param)});_.forOwn(s.currentDieList,function(a,t){var e={};e[t]=a,d.push(e)}),_.forOwn(l.otherDieType,function(a,t){var e={};e[t]=a,d.push(e)}),buildColorGradation({width:o,height:.8*o,container:n,bgFillColor:"#314067",waferData:l,spacePercent:{x:.1,y:0},param:r.param,m_DieDataListNew:d,colorGradation:{limitColor:"#FF0000",floorColor:"#00FF00",nums:256},callback:function(a,t){}})}function draw_map_color_order_distribution(a){var t=a.data,e=a.IDParamObj,r=a.IDParamObj.wafer,i=$("#"+e.id),o=_.find(t,function(a,t){return _.toString(t)==_.toString(r)});dieData=[],subdieData=[],currentDieItem=_.find(o.waferList,function(a,t){return _.toString(a.parameter)==_.toString(e.param)}),theMax=200,theMin=-100,lowwer=theMin+_.floor((theMax-theMin)/3),upper=theMin+2*_.floor((theMax-theMin)/3),midder=_.floor((theMax+theMin)/2),otherColor={},twoDiff=lowwer-theMin,threeDiff=midder-lowwer,fourDiff=upper-midder,fiveDiff=theMax-upper,precision=0;var n=o.containSubdie?o.waferDie.currentDieList:currentDieItem.currentDieList,l=o.containSubdie?[n]:[n,o.otherDieType];_.forEach(l,function(a,t){_.forOwn(a,function(a,t){var e,r,i,o,n,l={};n=_.isObject(a)?(o=a.percent,a.bin||a.subdieBin):o=a,e=_.round(parseFloat(o)*Math.pow(10,precision));var d=_.toString(o).match(/^\+/),s=_.toString(o).match(/^\-/);if(_.isObject(a)?_.isNil(d)&&_.isNil(s)?i=1:(_.isNil(d)||(i=100),_.isNil(s)||(i=-100)):_.isNil(d)&&_.isNil(s)?i=0:(_.isNil(d)||(i=2),_.isNil(s)||(i=-2)),2<i&&(e+=i),5e3==(r=n))"5000:"in otherColor||(otherColor["5000:"]="#FDFDFD"),l[t]={bin:5e3,color:"5000:"};else if(5001==r)"5001:"in otherColor||(otherColor["5001:"]="#fff"),l[t]={bin:5001,color:"5001:"};else if(-1==r)"-1:"in otherColor||(otherColor["-1:"]="#314067"),l[t]={bin:-1,color:"-1:"};else{var p=_.round(e);_.isNil(d)&&_.isNil(s)?lowwer<=e&&e<midder?l[t]={bin:r,color:"3:"+p}:midder<=e&&e<=upper&&(l[t]={bin:r,color:"4:"+p}):(_.isNil(d)||(upper<=e&&e<theMax?l[t]={bin:r,color:"5:"+p}:theMax<=e&&(e=theMax,l[t]={bin:r,color:"6:"+p})),_.isNil(s)||(e<=theMin?(e=theMin,l[t]={bin:r,color:"1:"+p}):theMin<e&&e<=lowwer&&(l[t]={bin:r,color:"2:"+p})))}dieData.push(l)})});var d=o.containSubdie?currentDieItem.currentSubdieList:{},s=(o.containSubdie&&o.otherSubdieType,o.containSubdie?[d]:[]);_.forEach(s,function(a,t){_.forOwn(a,function(a,t){var e,r,i,o,n,l={};n=_.isObject(a)?(o=a.percent,a.subdieBin):o=a,e=_.round(parseFloat(o)*Math.pow(10,precision));var d=_.toString(o).match(/^\+/),s=_.toString(o).match(/^\-/);if(_.isObject(a)?_.isNil(d)&&_.isNil(s)?i=1:(_.isNil(d)||(i=100),_.isNil(s)||(i=-100)):_.isNil(d)&&_.isNil(s)?i=0:(_.isNil(d)||(i=2),_.isNil(s)||(i=-2)),2<i&&(e+=i),5e3==(r=n))"5000:"in otherColor||(otherColor["5000:"]="#FDFDFD"),l[t]={bin:5e3,color:"5000:"};else if(5001==r)"5001:"in otherColor||(otherColor["5001:"]="#fff"),l[t]={bin:5001,color:"5001:"};else if(-1==r)"-1:"in otherColor||(otherColor["-1:"]="#314067"),l[t]={bin:-1,color:"-1:"};else{var p=_.round(e);_.isNil(d)&&_.isNil(s)?lowwer<=e&&e<midder?l[t]={bin:r,color:"3:"+p}:midder<=e&&e<=upper&&(l[t]={bin:r,color:"4:"+p}):(_.isNil(d)||(upper<=e&&e<theMax?l[t]={bin:r,color:"5:"+p}:theMax<=e&&(e=theMax,l[t]={bin:r,color:"6:"+p})),_.isNil(s)||(e<=theMin?(e=theMin,l[t]={bin:r,color:"1:"+p}):theMin<e&&e<=lowwer&&(l[t]={bin:r,color:"2:"+p})))}subdieData.push(l)})});var p={1:[],2:[],3:[],4:[],5:[],6:[],5e3:[],5001:[],"-1":[],12:[]};_.forEach(dieData,function(a,t){var e=_.values(a)[0].color.split(":")[0],r=_.keys(a)[0],i={};i.old1=_.find(currentDieItem.currentDieList,function(a,t){return t==r}),i.new1=a,p[e].push(i)}),window.ArraMap=p;var c=i.innerWidth();i.innerHeight(.8*c);var m="canvas_"+i.attr("id");i.append("<canvas id='"+m+"'></canvas>"),i.after("<div class='criterion_"+m+"'><div class='colorGradient'></div></div>"),buildColorGradation({width:c,height:.8*c,container:m,bgFillColor:"#314067",waferData:o,spacePercent:{x:.1,y:0},m_DieDataListNew:dieData,colorGradation:{theMinColor:"#0000FF",lowwerColor:"#00FFFF",midderColor:"#00FF00",upperColor:"#FFFF00",theMaxColor:"#FF0000",twoDiff:twoDiff,threeDiff:threeDiff,fourDiff:fourDiff,fiveDiff:fiveDiff},colorOrder:!0,theMin:theMin,lowwer:lowwer,midder:midder,upper:upper,theMax:theMax,otherColor:otherColor,param:a.IDParamObj.param,subcoordsArray:subdieData});var h=i.next().find("div.colorGradient");h.width(i.next().width()-60).height(i.next().height()-30);var u=twoDiff+threeDiff+fourDiff+fiveDiff,f=h.height(),g=h.width()/(1.2*u),b=_.floor((theMax-theMin)/200);$("body").innerWidth()<1920&&(b+=.5),$("body").innerWidth()<1366&&(b+=.5),h.append("<span class='colorGradientSpan oneSpan outSpan'><span style='height: "+f+"px; width: "+g+"px'></span></span>"),h.append("<span class='colorGradientSpan splitSpan' style='height: "+f+"px; width: "+g*b+"px;'></span>"),_.times(twoDiff,function(a){var t=getGradientColor("#00FFFF","#0000FF",twoDiff,twoDiff-a);h.append("<span class='colorGradientSpan' data-icolor='"+t+"' style='background: "+t+"; height: "+f+"px; width: "+g+"px'></span>")}),h.append("<span class='colorGradientSpan twoSpan outSpan'><span style='height: "+f+"px; width: "+g+"px'></span></span>"),h.append("<span class='colorGradientSpan splitSpan' style='height: "+f+"px; width: "+g*b+"px;'></span>"),_.times(threeDiff,function(a){var t=getGradientColor("#00FF00","#00FFFF",threeDiff,threeDiff-a);h.append("<span class='colorGradientSpan' data-icolor='"+t+"' style='background: "+t+"; height: "+f+"px; width: "+g+"px'></span>")}),h.append("<span class='colorGradientSpan threeSpan outSpan'><span style='height: "+f+"px; width: "+g+"px'></span></span>"),h.append("<span class='colorGradientSpan splitSpan' style='height: "+f+"px; width: "+g*b+"px;'></span>"),_.times(fourDiff,function(a){var t=getGradientColor("#FFFF00","#00FF00",fourDiff,fourDiff-a);h.append("<span class='colorGradientSpan' data-icolor='"+t+"' style='background: "+t+"; height: "+f+"px; width: "+g+"px'></span>")}),h.append("<span class='colorGradientSpan fourSpan outSpan'><span style='height: "+f+"px; width: "+g+"px'></span></span>"),h.append("<span class='colorGradientSpan splitSpan' style='height: "+f+"px; width: "+g*b+"px;'></span>"),_.times(fiveDiff,function(a){var t=getGradientColor("#FF0000","#FFFF00",fiveDiff,fiveDiff-a);h.append("<span class='colorGradientSpan' data-icolor='"+t+"' style='background: "+t+"; height: "+f+"px; width: "+g+"px'></span>")}),h.append("<span class='colorGradientSpan fiveSpan outSpan'><span style='height: "+f+"px; width: "+g+"px'></span></span>"),h.append("<span class='colorGradientSpan splitSpan' style='height: "+f+"px; width: "+g*b+"px;'></span>"),h.append("<span class='colorGradientSpan sixSpan outSpan'><span style='height: "+f+"px; width: "+g+"px'></span></span>");var v=_.countBy(dieData,function(a,t){var e;return _.forOwn(a,function(a,t){e=a.color.split(":")[0]}),e});$('<table class="table table-striped table-bordered table-condensed"><thead><tr><th></th><th></th><th></th><th></th><th></th><th></th><th>合格数</th><th>不合格数</th><th>良率</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td></td><td></td><td class="qualify_tt" data-ipara="qualify">0</td><td class="unqulify_tt" data-ipara="unqulify">0</td><td class="yield_tt" data-ipara="yield">0%</td></tr></tbody></table>').appendTo(i.parent().next()),_.forOwn(v,function(a,t){if(-1==_.indexOf(["1","2","3","4","5","6"],t))return!0;i.parent().next().find("th").eq(t-1).text(t+"区间"),i.parent().next().find("td").eq(t-1).text(a+"个")});var C=i.parent().next();C.find("[class$='_tt']").each(function(){var a=$(this).data("ipara");$(this).text(currentDieItem[a])}),C.find("th").each(function(a){""==$(this).text().trim()&&($(this).text(a+1+"区间"),C.find("td").eq(a).text("0个"))})}function findParamUpLow(e){var a={};if("ALL"==e.toLocaleUpperCase())a.up="无",a.low="无";else{var t=$("body").data("result").paramLimit,r=_.findIndex(t.paramList,function(a,t){return a.replace(/\([\s\S]*\)$/,"")==e});a.low=-1==r?a.up="无":(a.up=t.upperList[r],t.lowerList[r])}return _.cloneDeep(a)}function buildParameterChartContainer(a){var r=a.classify,t=a.paramsArr,i='<div class="container-fluid">',o=[];if(-1<["good_rate","histogram","boxlinediagram","CPK","correlationgraph"].indexOf(r))-1<["histogram"].indexOf(r)&&(t=_.pull(t,"sectionX")),_.forEach(t,function(a,t,e){t%2==0&&(i+='<div class="row">'),i+='<div class="col-sm-12 col-md-6 col-lg-6">',i+='<div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>'+a+'</div><div class="panel-body"><div class="container-fluid"><div class="chart_title"></div><div class="chart_body"><div id="'+(r+dataListDetailStore.state.parameterMap.curChartContainerNum)+'" data-iparam="'+a+'"></div></div><div class="chart_foot"></div></div></div></div>',i+="</div>",(t%2==1||t%2==0&&t==e.length-1)&&(i+="</div>"),o.push({id:r+dataListDetailStore.state.parameterMap.curChartContainerNum,param:a,isAll:!1}),dataListDetailStore.state.parameterMap.curChartContainerNum++}),i+="</div>";else if(-1<["map_good_rate_distribution","map_color_order_distribution"].indexOf(r)){for(var e=0;e<t.length;e++){i+='<div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>'+t[e]+'</div><div class="panel-body"><div class="container-fluid">';for(var n=0;n<a.waferArr.length;n++)n%2==0&&(i+='<div class="row">'),i+='<div class="col-sm-12 col-md-6 col-lg-6">',i+='<div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>'+a.curWaferName[a.waferArr[n]]+'</div><div class="panel-body"><div class="container-fluid"><div class="chart_title"></div><div class="chart_body"><div id="'+(r+dataListDetailStore.state.parameterMap.curChartContainerNum)+'" data-iparam="'+t[e][n]+'"></div></div><div class="chart_foot"></div></div></div></div>',i+="</div>",(n%2==1||n%2==0&&n==a.waferArr.length-1)&&(i+="</div>"),o.push({id:r+dataListDetailStore.state.parameterMap.curChartContainerNum,param:t[e],isAll:!1,wafer:a.waferArr[n]}),dataListDetailStore.state.parameterMap.curChartContainerNum++;i+="</div></div></div>"}i+="</div>"}return"all_statistics"==a.controls?$("#all_statistics .panel_"+r+">.panel-body").append(i):$("#"+r+" .single_div_in").append(i),o}function ajax_all_chart(o){for(var n=o.times,l=o.alltimes,d=o.whenArr,s=o.errorArr||[],p=o.curWaferName,c=d[n],m=[],h=[],a=[],t=0;t<$(".home_dataCompare_bottom table tbody tr").length;t++)m.push($(".home_dataCompare_bottom table tbody  tr").eq(t).find("input[type='checkbox']").data("ivalue"));for(t=0;t<$(".home_dataCompare_bottom .right_div  li").length;t++)$(".home_dataCompare_bottom .right_div  li").eq(t).hasClass("list-group-item-info")&&(0!=t&&a.push($(".home_dataCompare_bottom .right_div  li").eq(t).data("iparam")),h.push($(".home_dataCompare_bottom .right_div  li").eq(t).data("iparam")));if("correlationgraph"===c.classify)var e={waferIdStr:m.join(","),paramX:$(".home_dataCompare_bottom .right_div  li.list-group-item-info").eq(0).data("iparam"),paramY:$(".home_dataCompare_bottom .right_div  li.list-group-item-info").eq(1).data("iparam"),minX:$(".home_dataCompare_bottom .right_div  li.list-group-item-info").eq(0).data("min"),minY:$(".home_dataCompare_bottom .right_div  li.list-group-item-info").eq(1).data("min"),maxX:$(".home_dataCompare_bottom .right_div  li.list-group-item-info").eq(0).data("max"),maxY:$(".home_dataCompare_bottom .right_div  li.list-group-item-info").eq(1).data("max")};else e={waferIdStr:m.join(","),paramAtt:a};$.ajax({type:"GET",url:c.chartAjaxUrl,data:e,dataType:"json",beforeSend:function(){$("body").data("iglobalerror","allow"),$("#swal2-content").text("正在请求"+c.chartCNName+"数据，绘图进度 "+(n+1)+"/"+l)}}).then(function(e){var a=m;if(_.isEmpty(e)||_.isNil(e))s.push({chartCNName:c.chartCNName,errorParamArr:[],classify:c.classify,message:"数据为空"});else{if(-1<["map_good_rate_distribution","map_color_order_distribution"].indexOf(c.classify))var r=h;else if(-1<["good_rate"].indexOf(c.classify))r=h;else if(-1<["correlationgraph"].indexOf(c.classify))for(var t in delete e.status,r=[],p)r.push(p[t]);else r=_.keys(e),r=_.sortBy(r,function(a,t){return _.isNil(a.match(/\d+/))?0:_.toNumber(a.match(/\d+/)[0])});var i=buildParameterChartContainer({classify:c.classify,paramsArr:_.cloneDeep(r),waferArr:_.cloneDeep(a),curWaferName:p,controls:o.controls});_.forEach(i,function(a,t){"map_good_rate_distribution"==c.classify?draw_map_good_rate({IDParamObj:a,data:_.cloneDeep(e),curWaferName:p,paramsArr:r}):"map_color_order_distribution"==c.classify?draw_map_color_order_distribution({data:_.cloneDeep(e),IDParamObj:a,curWaferName:p,paramsArr:r}):s=draw_other_chart({chartType:c.chartType,classify:c.classify,IDParamObj:a,paramsArr:r,data:_.cloneDeep(e),curWaferId:m,errorArr:s,curWaferName:p})})}++n!=l?setTimeout(function(){ajax_all_chart({times:n,alltimes:l,whenArr:d,curWaferName:p,errorArr:s,controls:o.controls})},50):eouluGlobal.S_getSwalMixin()({title:"加载提示",text:"数据请求完成",type:"info",showConfirmButton:!1,timer:1200}).then(function(){if(_.isEmpty(s))eouluGlobal.S_getSwalMixin()({title:"加载提示",text:"全部图表绘制完成",type:"success",showConfirmButton:!1,timer:1200});else{var e="部分图表绘制完成，以下图表请求/绘制失败";e+='<div class="container-fluid"><table class="table table-striped table-bordered table-hover table-condensed"><thead><tr><th style="font-size:14px;width: 80px;text-align:center;">图表名字</th><th style="font-size:14px;text-align:center;">参数及原因</th></tr></thead><tbody>',_.forEach(s,function(t){e+='<tr><td style="vertical-align: top;font-size:14px;width: 80px;">'+t.chartCNName+'</td><td style="vertical-align: top;font-size:14px;">',_.isEmpty(t.errorParamArr)?e+=t.message:_.forEach(t.errorParamArr,function(a){e+=a+":"+t.message+"<br/>"}),e+="</td></tr>"}),e+="</tbody></table></div>",eouluGlobal.S_getSwalMixin()({title:"加载提示",html:e,showConfirmButton:!0})}$("body").data("iglobalerror","unallow"),dataListDetailStore.state.parameterMap.hasRender=!0})},function(){eouluGlobal.S_getSwalMixin()({title:"加载提示",text:c.chartCNName+"数据请求失败，请刷新页面或重新登录",type:"error",showConfirmButton:!1,timer:1800})}).always(function(){})}function dataCompareRenderData(n){var e=$("#search_input").val().trim();$.ajax({url:"DataListAjax",type:"GET",data:{currentPage:n,keyword:e},dataType:"json",async:!1,success:function(a){var o="";a.waferInfo.map(function(a,t,e){var r=a.wafer_id;if(a.test_operator)i=a.test_operator;else var i="";o+='<tr><td class="not_search"><input type="checkbox" data-ivalue="'+r+'"></td><td class="product_category" data-itext="'+a.product_category+'">'+a.product_category+'</td><td class="device_number" data-itext="'+a.device_number+'">'+a.device_number+'</td><td class="lot_number" data-itext="'+a.lot_number+'">'+a.lot_number+'</td><td class="wafer_number" data-itext="'+a.wafer_number+'">'+a.wafer_number+'</td><td class="die_type" data-itext="'+a.die_type+'">'+a.die_type+'</td><td class="qualified_rate" data-itext="'+a.qualified_rate+'">'+a.qualified_rate+'</td><td class="test_end_date" data-itext="'+a.test_end_date+'">'+a.test_end_date+'</td><td class="test_operator" data-itext="'+i+'">'+i+'</td><td class="description" data-itext="'+a.description+'">'+a.description+'</td><td class="data_format" data-itext="'+a.data_format+'" style="display:none;">'+a.data_format+'</td><td class="data_trash not_search"   data-page="'+n+'" ><img src="assets/img/common/del_24px.svg"  data-iicon="glyphicon-remove" alt="删除" title="删除" ></td></tr>'}),$(".home_dataCompare_top tbody").empty().append(o),dataCompareState.pageObj.pageCount=a.totalPage,dataCompareState.pageObj.itemLength=a.totalCount,dataCompareState.pageObj.data=a.waferInfo,dataCompareState.searchObj.hasSearch?(dataCompareState.searchObj.searchVal=e,$(".home_dataCompare_top tbody [type='checkbox']").each(function(){-1<_.indexOf(dataCompareState.sellectObj.selectItem,$(this).data("ivalue").toString())&&$(this).prop("checked",!0).parent().parent().addClass("warning").removeClass("info")}),$(".home_dataCompare_top tbody td:not(.not_search)").each(function(){var a=$(this).text(),t="<b style='color:red'>"+dataCompareState.searchObj.searchVal+"</b>",e=a.replace(new RegExp(dataCompareState.searchObj.searchVal,"g"),t);$(this).empty().html(e)})):$(".home_dataCompare_top tbody [type='checkbox']").each(function(){-1<_.indexOf(dataCompareState.sellectObj.selectItem,$(this).data("ivalue").toString())&&$(this).prop("checked",!0).parent().parent().addClass("warning").removeClass("info")}),$("#checkAll").prop("checked",dataCompareState.pageObj.itemLength==dataCompareState.sellectObj.selectItem.length),dataCompareState.curPageSelectAll={};for(var t=0;t<a.totalPage;t++)dataCompareState.curPageSelectAll[t+1]=!1},error:function(a,t,e){dataCompareSwalMixin({title:"异常",text:"服务器繁忙！",type:"error",showConfirmButton:!1,timer:2e3})}})}function eleResize(){var a=$(window).height();a<600&&(a=600),$("body").height(a),$(".g_bodyin_bodyin_bottom").innerHeight(a-165),$(".g_bodyin_bodyin_bottom>.tab-content").innerHeight(a-165),$(".home_dataCompare_top .body_div").innerHeight(a/2-83),$(".home_dataCompare_bottom .left_div, .home_dataCompare_bottom .right_div").innerHeight(a/2-92),$(".home_dataCompare_bottom .right_div .panel-body").innerHeight(a/2-175)}function judgeNav(a){{if("wafer"==a.classify)return 0==dataCompareState.sellectObj.selectItem.length?($(".g_bodyin_bodyin_top_wrap>ul").empty().append('<li role="presentation" class="active"><a href="#home_dataCompare" aria-controls="home_dataCompare" role="tab" data-toggle="tab">主页面</a></li>'),dataCompareState.stateObj.canClickParam=!1,dataCompareState.stateObj.curParam=null,!1):(dataCompareState.stateObj.canClickParam=!0,judgeNav({classify:"param",param:{TotalYield:a.param.TotalYield,other:_.cloneDeep(a.param.other)}}));if("param"==a.classify){var t=[];return dataCompareState.stateObj.curParam=_.cloneDeep(a.param),0==a.param.TotalYield?0==a.param.other.length?t.length=0:2==a.param.other.length?t=_.cloneDeep([{href:"map_good_rate_distribution",text:"Map良率分布",value:44},{href:"map_color_order_distribution",text:"Map色阶分布",value:45},{href:"good_rate",text:"良品率图",value:46},{href:"histogram",text:"直方图",value:47},{href:"boxlinediagram",text:"箱线图",value:48},{href:"CPK",text:"CPK图",value:49},{href:"correlationgraph",text:"相关性图",value:50}]):2!=a.param.other.length&&(t=_.cloneDeep([{href:"map_good_rate_distribution",text:"Map良率分布",value:44},{href:"map_color_order_distribution",text:"Map色阶分布",value:45},{href:"good_rate",text:"良品率图",value:46},{href:"histogram",text:"直方图",value:47},{href:"boxlinediagram",text:"箱线图",value:48},{href:"CPK",text:"CPK图",value:49}])):t=[{href:"map_good_rate_distribution",text:"Map良率分布",value:44},{href:"good_rate",text:"良品率图",value:46}],t}}}function renderNav(a){if(!1!==a){var r='<li role="presentation" class="active" ischange ="false"><a href="#home_dataCompare" aria-controls="home_dataCompare" role="tab" data-toggle="tab">主页面</a></li>',i=eouluGlobal.S_getCurPageJudgedAuthority().diff,o=!1;a.map(function(e,a,t){if(_.find(i,function(a,t){return a[0].value==e.value}))return!0;r+='<li role="presentation" ischange ="false"><a href="#'+e.href+'" aria-controls="'+e.href+'" data-controls="'+e.href+'" role="tab" data-toggle="tab">'+e.text+"</a></li>",o=!0}),!_.isEmpty(a)&&o&&(r+='<li role="presentation" ischange ="false"><a href="#all_statistics" aria-controls="all_statistics" role="tab" data-toggle="tab">所有统计</a></li>'),$(".g_bodyin_bodyin_top_wrap>ul").empty().append(r)}}function groupJudgeRenderNav(a){var t=[];$("#home_param_ul>li.list-group-item-info:not([data-iparam='Total Yield'])").each(function(){t.push($(this).data("iparam"))}),renderNav(judgeNav({classify:a,param:{TotalYield:$("#home_param_ul>li.list-group-item-info[data-iparam='Total Yield']").length,other:_.cloneDeep(t)}}))}function renderCommonParameter(){var a=dataCompareState.sellectObj.selectItem.join(",");""!=a?$.ajax({url:"ParameterRange",type:"GET",data:{waferIdStr:a},dataType:"json",success:function(a){var t="";if(0!=a.paramList.length){t='<li class="list-group-item" data-iparam="Total Yield"><span class="badge">选中</span>Total Yield</li>';for(var e=0;e<a.paramList.length;e++)t+='<li class="list-group-item" data-iparam="'+a.paramList[e]+'" data-min="'+a.rangeList[a.paramList[e]][0]+'" data-max="'+a.rangeList[a.paramList[e]][1]+'"><span class="badge">选中</span>'+a.paramList[e]+"</li>"}else t='<li class="list-group-item" data-iparam="Total Yield"><span class="badge">选中</span>Total Yield</li>';$("#home_param_ul").empty().append(t),$(".home_dataCompare_bottom .right_div .allchoose").text("全选").prop("ischoose",!1)},error:function(a,t,e){dataCompareSwalMixin({title:"异常",text:"服务器繁忙！",type:"error",showConfirmButton:!1,timer:2e3})}}):$("#home_param_ul").empty()}function renderPanel(a,t,e,r,i){var o="";if("map_good_rate_distribution"==e||"map_color_order_distribution"==e){if(1==a&&"map_good_rate_distribution"==e){o+='<div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>Total Yield</div><div class="panel-body"><div class="container-fluid">';var n=buildMapContainer({divi:3,controls:e,iparam:"TotalYield",iclassify:"map"});o+=n,o+="</div></div></div>"}t.map(function(a,t){o+='<div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>'+a+'</div><div class="panel-body"><div class="container-fluid">',o+=buildMapContainer({divi:3,controls:e,iparam:a,iclassify:"map"}),o+="</div></div></div>"})}else if("good_rate"==e){var l=2;(6<dataCompareState.sellectObj.selectItem.length||1==dataCompareState.stateObj.curParam.other.length)&&(l=1),o=buildMapContainer({divi:l,controls:e,iparam:null,iclassify:"otherSingle"})}else if(-1<["histogram","boxlinediagram","CPK"].indexOf(e)){var d=2;(6<dataCompareState.sellectObj.selectItem.length||1==dataCompareState.stateObj.curParam.other.length)&&(d=1),o=buildMapContainer({divi:d,controls:e,iparam:null,iclassify:"otherSingleNotTY"})}else"correlationgraph"==e&&(o=buildMapContainer({divi:1,controls:e,iparam:dataCompareState.stateObj.curParam.other.join(" VS "),iclassify:"correlationgraph"}));!0===r?i&&i(o):$("div[role='tabpanel']#"+e+">.single_div_in").empty().append(o)}function buildMapContainer(a){var r="",i=a.divi,o=a.controls,n=a.iparam,t=a.iclassify;if("otherSingle"==t||"otherSingleNotTY"==t){var e=[];"otherSingle"==t&&(e[dataCompareState.stateObj.curParam.TotalYield]="TotalYield",_.pullAt(e,0));var l=_.concat(e,dataCompareState.stateObj.curParam.other),d=Math.ceil(l.length/i),s=_.join(_.sortBy(dataCompareState.sellectObj.selectItem));r+='<div class="container-fluid">',_.times(d,function(e){r+='<div class="row">',_.times(i,function(a){var t=e*i+a;t<l.length&&(r+='<div class="col-sm-12 col-md-'+12/i+" col-lg-"+12/i+'">',r+='<div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>'+l[t]+'</div><div class="panel-body"><div class="chart_otherSingle_tit">头</div><div class="chart_otherSingle_body"><div id="'+(o+dataCompareState.stateObj.curChartContainerNum)+'" data-ivalue="'+s+'" data-ichart="'+o+'" data-iparam="'+l[t]+'"></div></div><div class="chart_otherSingle_foot">脚</div></div></div>',r+="</div>",dataCompareState.stateObj.curChartContainerNum++)}),r+="</div>"}),r+="</div>"}else if("map"==t){var p=dataCompareState.sellectObj.selectItem.length,c=Math.ceil(p/i);_.times(c,function(e){r+='<div class="row">',_.times(i,function(a){var t=e*i+a;t<p&&(r+='<div class="col-sm-6 col-md-'+12/i+" col-lg-"+12/i+'">',r+='<div class="chart_map_tit">wafer'+dataCompareState.sellectObj.selectItem[t]+"</div>",r+='<div class="chart_map_body"><div id="'+(o+dataCompareState.stateObj.curChartContainerNum)+'" data-ivalue="'+dataCompareState.sellectObj.selectItem[t]+'" data-ichart="'+o+'" data-iparam="'+n+'"></div></div>',r+='<div class="chart_map_foot"></div>',r+="</div>",dataCompareState.stateObj.curChartContainerNum++)}),r+="</div>"})}else if("correlationgraph"==t){var m=_.join(_.sortBy(dataCompareState.sellectObj.selectItem));r+='<div class="container-fluid"><div class="row"><div class="col-sm-12 col-md-12 col-lg-12"><div class="panel panel-info"><div class="panel-heading"><span class="glyphicon glyphicon-menu-down" aria-hidden="true"></span>'+n+'</div><div class="panel-body"><div class="chart_otherSingle_tit">头</div><div class="chart_otherSingle_body"><div id="'+(o+dataCompareState.stateObj.curChartContainerNum)+'" data-ivalue="'+m+'" data-ichart="'+o+'" data-iparam="'+n+'"></div></div><div class="chart_otherSingle_foot">脚</div></div></div></div></div></div>',dataCompareState.stateObj.curChartContainerNum++}return r}dataListDetailStore.state=Object.create(null),dataListDetailStore.state={allDetail:{tbody:{scrollTop:0,scrollLeft:0}},parameterMap:{curChartContainerNum:0,hasRender:!1,ajaxLength:0},chartTypeMap:{map_good_rate_distribution:null,map_color_order_distribution:null,good_rate:"spline",histogram:"column",boxlinediagram:"boxplot",CPK:"line",correlationgraph:"scatter"},chartAjaxUrlMap:{map_good_rate_distribution:"WaferMap",map_color_order_distribution:"ColorMap",good_rate:"ShowYield",histogram:"Histogram",boxlinediagram:"Boxplot",CPK:"CPKServlet",correlationgraph:"Correlation"},chartCNNameMap:{map_good_rate_distribution:"Map良率分布",map_color_order_distribution:"Map色阶分布",good_rate:"良品率图",histogram:"直方图",boxlinediagram:"箱线图",CPK:"CPK图",correlationgraph:"相关性图"}},$(document).on("shown.bs.tab",'div.g_bodyin_bodyin_top_wrap a[data-toggle="tab"]',function(a){if("true"==$(this).parent().attr("ischange"))return!0;$(this).parent().attr("ischange","true");for(var t=[],i={},e=0;e<$(".home_dataCompare_bottom table tbody tr").length;e++)t.push($(".home_dataCompare_bottom table tbody  tr").eq(e).find("input[type='checkbox']").data("ivalue")),i[$(".home_dataCompare_bottom table tbody  tr").eq(e).find("input[type='checkbox']").data("ivalue")]=$(".home_dataCompare_bottom table tbody  tr").eq(e).find(".wafer_number").text();dataCompareState.stateObj.curParam;var o=$(a.target).attr("aria-controls");if($(".g_info_m, .g_info_r .glyphicon-search, .g_info .glyphicon-question-sign").hide(),"home_dataCompare"==o)$(".g_info_m, .g_info .glyphicon-question-sign").show(),dataCompareState.stateObj.searchShow&&$(".g_info_r .glyphicon-search").show();else if("all_statistics"==o){eouluGlobal.S_getSwalMixin()({title:"加载数据",text:"数据加载绘制图形中...",type:"info",showConfirmButton:!1,showCancelButton:!1}),$("#all_statistics>.panel").hide();for(var r=1;r<$(".g_bodyin_bodyin_top_wrap>ul li").length-1;r++){var n=$(".g_bodyin_bodyin_top_wrap>ul li").eq(r).find("a").data("controls");$("#all_statistics .panel_"+n).show()}$("#all_statistics>.panel>.panel-body").empty(),setTimeout(function(){var n=[];$("#all_statistics>div.panel").each(function(a,t){if("none"==$(this).css("display"))return!0;var e=$(t).data("iallstatistics"),r=_.find(dataListDetailStore.state.chartTypeMap,function(a,t){return t==e}),i=_.find(dataListDetailStore.state.chartAjaxUrlMap,function(a,t){return t==e}),o=_.find(dataListDetailStore.state.chartCNNameMap,function(a,t){return t==e});n.push({chartType:r,chartAjaxUrl:i,chartCNName:o,classify:e})}),ajax_all_chart({times:0,alltimes:n.length,whenArr:_.cloneDeep(n),curWaferName:i,controls:"all_statistics"})},50)}else eouluGlobal.S_getSwalMixin()({title:"加载数据",text:"数据加载绘制图形中...",type:"info",showConfirmButton:!1,showCancelButton:!1}),setTimeout(function(){$("#"+o+" .single_div_in").empty();var a=_.find(dataListDetailStore.state.chartTypeMap,function(a,t){return t==o}),t=_.find(dataListDetailStore.state.chartAjaxUrlMap,function(a,t){return t==o}),e=_.find(dataListDetailStore.state.chartCNNameMap,function(a,t){return t==o}),r=[];r.push({chartType:a,chartAjaxUrl:t,chartCNName:e,classify:o}),ajax_all_chart({times:0,alltimes:r.length,whenArr:_.cloneDeep(r),curWaferName:i,controls:"single_statistics"})},50);if("all_statistics"==$(this).attr("aria-controls")){var l=$("#all_statistics>.panel>.panel-heading>span");l.removeClass("glyphicon-menu-right").addClass("glyphicon-menu-down").parent().parent().removeClass("panel-success").addClass("panel-info"),l.parent().next().slideDown(200)}}),$(".g_info_m_in").hide(),eleResize(),$(window).on("resize",function(){eleResize()}),$(function(){if(_.isEqual(_.toUpper(eouluGlobal.S_getBrowserType()[0]),"IE")||_.isEqual(_.toUpper(eouluGlobal.S_getBrowserType()[0]),"IE11")){var a=$(".g_body").width();$(".g_bodyin_bodyin_top,.g_bodyin_bodyin_top_wrap,.g_bodyin_bodyin_bottom,.body_div,.home_dataCompare").width(a)}eouluGlobal.C_pageAuthorityCommonHandler({authorityJQDomMap:_.cloneDeep({"管理员":[$(".g_info_r  .AdminOperat")]})}),$(".breadcrumb li:eq(0) a ").attr("href","./HomeInterface"),dataCompareRenderData(1),dataCompareState.pageObj.selector="#pagelist",dataCompareState.pageObj.pageOption={limit:10,count:dataCompareState.pageObj.itemLength,curr:1,ellipsis:!0,pageShow:2,hash:!1,callback:function(a){dataCompareState.pageObj.currentPage=a.curr,a.isFirst||(dataCompareRenderData(a.curr),$("#checkAll").prop("checked",$(".home_dataCompare_top tbody tr.warning").length==$(".home_dataCompare_top tbody tr").length))}},dataCompareState.paginationObj.normal=new Pagination(dataCompareState.pageObj.selector,dataCompareState.pageObj.pageOption)}),$(".g_info_r>.glyphicon-search").click(function(){var a=$(".g_info_m").innerWidth();$(this).css("position","relative").animate({left:-(a/2+20)+"px"},500,"swing",function(){$(this).fadeOut(200,function(){$(".g_info_m_in").fadeIn(200).fadeTo(1,1),dataCompareState.stateObj.searchShow=!1})})}),$(".g_info_m_in span.input-group-addon").click(function(){$(".g_info_m_in").fadeTo(0,200,function(){$(this).fadeOut(200),$(".g_info_r>.glyphicon-search").fadeIn(100).animate({left:"0px"},600,"swing",function(){$(this).css("position","static"),dataCompareState.stateObj.searchShow=!0})})}),$(document).on("mouseover",".home_dataCompare_top td",function(){$(this).addClass("warning").parent().addClass("info")}).on("mouseout",".home_dataCompare_top td",function(){$(this).removeClass("warning").parent().removeClass("info")}).on("click",".home_dataCompare_top td",function(){var t=$(this),a=t.parent().find("input[type='checkbox']").data("ivalue").toString();$.ajax({url:"Examine",type:"GET",data:{waferId:a},dataType:"json",success:function(a){if(!a)return dataCompareSwalMixin({title:"提示",text:"无数据，不能访问",type:"warning",showConfirmButton:!1,timer:2e3}),!1;t.parent().toggleClass("warning info").find("[type='checkbox']").prop("checked",!t.parent().find("[type='checkbox']").prop("checked")).change()},error:function(a,t,e){dataCompareSwalMixin({title:"异常",text:"服务器繁忙！",type:"error",showConfirmButton:!1,timer:2e3})}})}).on("click",".home_dataCompare_top tbody [type='checkbox']",function(a){a.stopPropagation(),$(this).parent().parent().toggleClass("warning info")}).on("change",".home_dataCompare_top tbody [type='checkbox']",function(){var a=$(this).data("ivalue").toString(),t=!0;if($(this).prop("checked")){if($.ajax({url:"Examine",type:"GET",data:{waferId:a},dataType:"json",async:!1,success:function(a){t=a},error:function(a,t,e){dataCompareSwalMixin({title:"异常",text:"服务器繁忙！",type:"error",showConfirmButton:!1,timer:2e3})}}),!t)return $(this).prop("checked",!1),dataCompareSwalMixin({title:"提示",text:"无数据，不能访问",type:"warning",showConfirmButton:!1,timer:2e3}),!1;dataCompareState.sellectObj.selectItem.push(a),dataCompareState.searchObj.hasSearch&&dataCompareState.sellectObj.selectSearchItem.push(a),$(".home_dataCompare_bottom tbody>tr [type='checkbox'][data-ivalue='"+Number(a)+"']").parent().parent().remove(),$(".home_dataCompare_bottom tbody").append($(this).parent().parent().clone()),$(".home_dataCompare_bottom tbody tr, .home_dataCompare_bottom tbody td").removeClass("info warning")}else _.pull(dataCompareState.sellectObj.selectItem,a),dataCompareState.searchObj.hasSearch&&_.pull(dataCompareState.sellectObj.selectSearchItem,a),$(".home_dataCompare_bottom tbody [type='checkbox'][data-ivalue='"+Number(a)+"']").parent().parent().remove(),dataCompareState.curPageSelectAll[dataCompareState.pageObj.currentPage]=!1;dataCompareState.sellectObj.selectItem=_.uniq(dataCompareState.sellectObj.selectItem),dataCompareState.sellectObj.selectSearchItem=_.uniq(dataCompareState.sellectObj.selectSearchItem),$("#checkAll").prop("checked",$(".home_dataCompare_top tbody tr.warning").length==$(".home_dataCompare_top tbody tr").length),dataCompareState.sellectObj.selectAll=$("#checkAll").prop("checked"),renderCommonParameter(),groupJudgeRenderNav("wafer")}),$("#checkAll").on({click:function(){var i=dataCompareState.pageObj.currentPage,a=$(this);if(dataCompareState.curPageSelectAll[i])a.prop("checked",!1),dataCompareState.curPageSelectAll[i]=!1,$(".home_dataCompare_top tbody tr.warning").each(function(){-1<_.indexOf(dataCompareState.sellectObj.selectItem,$(this).find("input[type='checkbox']").data("ivalue").toString())&&(dataCompareState.sellectObj.selectItem.splice(dataCompareState.sellectObj.selectItem.indexOf($(this).find("input[type='checkbox']").data("ivalue").toString()),1),$(".home_dataCompare_bottom tbody>tr  input[data-ivalue ='"+$(this).find("input[type='checkbox']").data("ivalue")+"']").parent().parent().remove(),$(this).removeClass("warning info").find("input[type='checkbox']").prop("checked",!1))});else{dataCompareState.curPageSelectAll[i]=!0;var o=0,n=[];if($(".home_dataCompare_top tbody [type='checkbox']").each(function(){var a=$(this).data("ivalue"),r=$(this);$.ajax({url:"Examine",type:"GET",data:{waferId:a},dataType:"json",async:!1,success:function(a){var t=r.parent().parent();if(a){if(_.indexOf(dataCompareState.sellectObj.selectItem,r.data("ivalue").toString())<0){r.prop("checked",!0),r.parent().parent().removeClass("info").addClass("warning"),o++,dataCompareState.sellectObj.selectItem.push(r.data("ivalue").toString());var e='<tr><td class="not_search"><input type="checkbox" data-ivalue="'+t.find("input[type='checkbox']").data("ivalue")+'"></td><td class="product_category" data-itext="'+t.find(".product_category").text()+'">'+t.find(".product_category").text()+'</td><td class="device_number" data-itext="'+t.find(".device_number").text()+'">'+t.find(".device_number").text()+'</td><td class="lot_number" data-itext="'+t.find(".lot_number").text()+'">'+t.find(".lot_number").text()+'</td><td class="wafer_number" data-itext="'+t.find(".wafer_number").text()+'">'+t.find(".wafer_number").text()+'</td><td class="die_type" data-itext="'+t.find(".die_type").text()+'">'+t.find(".die_type").text()+'</td><td class="qualified_rate" data-itext="'+t.find(".qualified_rate").text()+'">'+t.find(".qualified_rate").text()+'</td><td class="test_end_date" data-itext="'+t.find(".test_end_date").text()+'">'+t.find(".test_end_date").text()+'</td><td class="test_operator" data-itext="'+t.find(".test_operator").text()+'">'+t.find(".test_operator").text()+'</td><td class="description" data-itext="'+t.find(".description").text()+'">'+t.find(".description").text()+'</td><td class="data_format" data-itext="'+t.find(".data_format").text()+'" style="display:none;">'+t.find(".data_format").text()+'</td><td  class="data_trash" data-page="'+i+'"><img src="assets/img/common/del_24px.svg"  data-iicon="glyphicon-remove" alt="删除" title="删除" ></td></tr>';$(".home_dataCompare_bottom tbody>tr").length?$(".home_dataCompare_bottom tbody>tr:first").before(e):$(".home_dataCompare_bottom tbody").append(e)}}else n.push([t.find(".wafer_number").text(),t.find(".die_type").text()])},error:function(a,t,e){dataCompareSwalMixin({title:"异常",text:"服务器繁忙！",type:"error",showConfirmButton:!1,timer:2e3})}})}),!_.isEmpty(n)){var t="";t+='<div class="container-fluid"><table class="table table-striped table-bordered table-hover table-condensed"><thead><tr><th style="font-size:14px;width: 80px;text-align:center;">无数据晶圆</th></tr></thead><tbody>';for(var e=0;e<n.length;e++)t+='<tr><td style="vertical-align: top;font-size:14px;">'+n[e][0]+" : "+n[e][1]+"</td></tr>";t+="</tbody></table></div>",eouluGlobal.S_getSwalMixin()({title:"当前页部分晶圆无数据",html:t,showConfirmButton:!0})}a.prop("checked",o==$(".home_dataCompare_top tbody tr").length)}dataCompareState.sellectObj.selectAll=a.prop("checked"),renderCommonParameter(),groupJudgeRenderNav("wafer")}}),$(document).on("click",".home_dataCompare_bottom .data_trash",function(){var t=$(this).parent().find("input[type='checkbox']").data("ivalue").toString();$(".home_dataCompare_top tr input[type='checkbox'][data-ivalue='"+t+"']").prop("checked",!1).parent().parent().removeClass("warning"),_.remove(dataCompareState.sellectObj.selectItem,function(a){return a==t}),$("#checkAll").prop("checked",!1),dataCompareState.sellectObj.selectAll=$("#checkAll").prop("checked"),renderCommonParameter(),groupJudgeRenderNav("wafer"),$(this).parent().remove(),dataCompareState.curPageSelectAll[$(this).data("page")]=!1}),$(document).on("dblclick",".home_dataCompare_bottom .home_dataCompare_bottom_del_all",function(){$(".home_dataCompare_top .warning").removeClass("warning").find("input[type='checkbox']").prop("checked",!1),dataCompareState.sellectObj.selectItem=[],$("#checkAll").prop("checked",!1),dataCompareState.sellectObj.selectAll=$("#checkAll").prop("checked"),renderCommonParameter(),groupJudgeRenderNav("wafer"),$(".home_dataCompare_bottom tbody").empty(),_.forOwn(dataCompareState.curPageSelectAll,function(a,t){dataCompareState.curPageSelectAll[t]=!1})}),$(".g_info_m_in .form-control-feedback").click(function(){$(this).prev().children("input").val("")}),$("#search_input").on("input propertychange change",function(){""!=$(this).val().trim()?$(this).parent().parent().next().removeClass("btn-default").addClass("btn-primary").prop("disabled",!1):($(this).val(""),$(this).parent().parent().next().removeClass("btn-primary").addClass("btn-default").prop("disabled",!0))}).on("keyup",function(a){13==(a.keyCode||a.which||a.charCode)&&""!=$(this).val().trim()&&$(this).parent().parent().next().trigger("click")}),$("#search_button").on("click",function(){$("#checkAll").prop("checked",!1),dataCompareState.sellectObj.selectSearchItem=[];var a=$("#search_input").val().trim();return dataCompareState.searchObj.hasSearch=""!=a,dataCompareState.searchObj.searchVal=1==dataCompareState.searchObj.hasSearch?a:null,dataCompareRenderData(1),dataCompareState.searchObj.hasSearch?(dataCompareState.pageSearchObj.currentPage=1,dataCompareState.pageSearchObj.pageOption.curr=1,dataCompareState.pageSearchObj.pageOption.count=dataCompareState.pageSearchObj.itemLength,$("ol#pagelist").remove(),$("span.futureDT2_page_span").before('<ol class="pagination" id="pagelist"></ol>'),dataCompareState.paginationObj.search=new Pagination(dataCompareState.pageSearchObj.selector,dataCompareState.pageSearchObj.pageOption)):(dataCompareState.pageObj.pageOption.curr=1,dataCompareState.pageObj.pageOption.count=dataCompareState.pageObj.itemLength,$("ol#pagelist").remove(),$("span.futureDT2_page_span").before('<ol class="pagination" id="pagelist"></ol>'),dataCompareState.paginationObj.normal=new Pagination(dataCompareState.pageObj.selector,dataCompareState.pageObj.pageOption)),!1}),$("#jumpText").on("input propertychange",function(){$(this).val($(this).val().replace(/[^\d]/g,""))}),$("#jumpPage").on("click",function(){var a=Number($("#jumpText").val()),t=Number(dataCompareState.pageObj.currentPage),e=Number(dataCompareState.pageObj.pageCount);dataCompareState.searchObj.hasSearch&&(t=Number(dataCompareState.pageSearchObj.currentPage),e=Number(dataCompareState.pageSearchObj.pageCount)),t==a||a<=0||e<a?$("#jumpText").val(""):dataCompareState.searchObj.hasSearch?(dataCompareState.pageSearchObj.pageOption.curr=a,dataCompareState.paginationObj.search.goPage(a),dataCompareState.paginationObj.search.renderPages(),dataCompareRenderData(dataCompareState.paginationObj.search.options.curr=a)):(dataCompareState.pageObj.pageOption.curr=a,dataCompareState.paginationObj.normal.goPage(a),dataCompareState.paginationObj.normal.renderPages(),dataCompareRenderData(dataCompareState.paginationObj.normal.options.curr=a))}),$(document).on("click",".home_dataCompare_bottom .panel-body li",function(){if(!dataCompareState.stateObj.canClickParam)return!1;$(this).toggleClass("list-group-item-info").children("span").text(["选中","取消选中"][Number($(this).hasClass("list-group-item-info"))]),groupJudgeRenderNav("param")}),$(document).on("click",".home_dataCompare_bottom .right_div .allchoose",function(){if(0==$(".right_div>.panel>.panel-body ul li").length)return!1;$(this).prop("ischoose")?($(this).text("全选").prop("ischoose",!1),$(".right_div>.panel>.panel-body ul li").removeClass("list-group-item-info").children("span").text("选中")):($(this).text("取消全选").prop("ischoose",!0),$(".right_div>.panel>.panel-body ul li").addClass("list-group-item-info").children("span").text("取消选中")),groupJudgeRenderNav("param")}),$(document).on("click",".g_bodyin_bodyin_bottom div.panel-heading>span.glyphicon",function(){$(this).toggleClass("glyphicon-menu-down glyphicon-menu-right").parent().parent().toggleClass("panel-info panel-success"),$(this).hasClass("glyphicon-menu-right")?$(this).parent().next().slideUp(200):$(this).parent().next().slideDown(200)});