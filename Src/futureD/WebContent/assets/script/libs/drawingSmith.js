function smithChart(e){var t=e.dom,l=e.titleOneArr,s=e.legendNameOneArr,O=e.allDataArr,i=e.Type,V=e.msgdom,a=e.lineColorArray,Y=e.msgFun,o=e.msgInitFun,_=e.GHzFlag,j=e.HzLv||1e7;t.innerHTML="",t.innerHTML='<div class="picName" style="position: absolute;"> </div><div class="value" style="position:absolute;z-index:1"></div> <div class="pointValue" style="position:absolute;z-index:1"></div><div class="line1" style="position:absolute;z-index:1"></div> <div class="line2" style="position:absolute;z-index:1"></div><canvas class="canvas" style="position: absolute;"></canvas><div class="legend" style="position: absolute;display:none;"></div>';var J=t.getElementsByClassName("picName")[0],K=t.getElementsByClassName("legend")[0],r=l,Q=s,R=O;J.innerHTML=r[0],J.style.cssText="text-align: center;font-size: 20px;font-weight: bold;font-family: 宋体;display:none;";var U=t.getElementsByClassName("value")[0],Z=t.getElementsByClassName("pointValue")[0],$=t.getElementsByClassName("line1")[0],ee=t.getElementsByClassName("line2")[0],te=t.getElementsByClassName("canvas")[0];te.setAttribute("width",t.offsetWidth),te.setAttribute("height",t.offsetHeight);var le=0,se=te.width,ie=te.height,ae=te.getContext("2d");function n(e,t,l,s,i){this.type=e,this.axis=t,this.valueType=l,this.axisPointer=s,this.color=i}if(n.prototype.type="SmithPlot",n.prototype.plot=function(){var e=this.type,f=this.valueType,m=le,t=this.axisPointer,b=this.color;J.style.height=le+"px",J.style.lineHeight=le+"px",J.style.color=b[7],J.style.width=te.width+"px",K.style.top=ie<se?1.1*ie+"px":1.05*se+le+"px";var l,s,i,a,o,r,n,u,P,d,y,h,x,p=[],g=[],v=[],c=[],M=[],k=[],T=[],C=[],H=[],w=[];if("S11"==e||"S22"==e){for(p=[.2,.4,.8,1,1.5,2,3,4,5,10,50],d=s=0;d<p.length;d++)g[d]=1/(1+p[d]),v[d]=p[d]/(1+p[d]);for(a=1,y=0;y<p.length;y++)M[y]=1/p[y],k[y]=1/p[y];for(r=1,h=0;h<p.length;h++)C[h]=-1/p[h],H[h]=1/p[h];n=1,P=u=0,x=Math.min(se,ie)/2}else"S12"==e?p=[.02,.04,.06,.08,.1,.12,.14]:"S21"==e&&(p=[5,10,15,20]);P=(u=ie<se?(u-n)*x+2*x+Math.abs(se-ie)/2:(u-n)*x+2*x,(P-n)*x+2*x);var L=n*x;for(ae.beginPath(),ae.arc(u,P,L,0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke(),ae.font="6px",ae.strokeText(n-1,u-L,P),ae.closePath(),ae.beginPath(),ae.arc(u,P,L,0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke(),ae.clip(),ae.closePath(),d=0;d<p.length;d++)l=(v[d]=ie<se?(v[d]-n)*x+2*x+Math.abs(se-ie)/2:(v[d]-n)*x+2*x,(s-n)*x+2*x),c[d]=g[d]*x,ae.beginPath(),ae.arc(v[d],l,c[d],0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke(),ae.font="6px",ae.strokeText(p[d],v[d]-c[d],l);for(y=0;y<p.length;y++){k[y]=(i=ie<se?(a-n)*x+2*x+Math.abs(se-ie)/2:(a-n)*x+2*x,(M[y]-n)*x+2*x),T[y]=M[y]*x,ae.beginPath(),ae.arc(i,k[y],T[y],0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke();var N=v[y]-c[y]+.2*x;N<=i-T[y]&&(N=i-T[y]);var S=-Math.sqrt(T[y]*T[y]-(N-i)*(N-i))+k[y];ae.font="6px",ae.strokeText(-p[y],N,S),ae.closePath()}for(h=0;h<p.length;h++){H[h]=(o=ie<se?(r-n)*x+2*x+Math.abs(se-ie)/2:(r-n)*x+2*x,(C[h]-n)*x+2*x),w[h]=Math.abs(C[h])*x,ae.beginPath(),ae.arc(o,H[h],w[h],0,2*Math.PI),ae.strokeStyle=b[0],ae.stroke();var F=v[h]-c[h]+.2*x;F<=o-w[h]&&(F=o-w[h]);var E=Math.sqrt(w[h]*w[h]-(F-o)*(F-o))+H[h];ae.font="6px",ae.strokeText(p[h],F,E),ae.closePath()}1==this.axis&&(ae.beginPath(),ae.moveTo(0,P),ae.lineTo(se,P),ae.strokeStyle=b[1],ae.stroke(),ae.closePath(),ae.beginPath(),ae.moveTo(u,0),ae.lineTo(u,ie),ae.strokeStyle=b[1],ae.stroke(),ae.closePath());var I=R.length;if(K.style.left=se/2-25*I+"px",0<I){var z=new Array(I);K.innerHTML="";for(var B=0;B<I;B++){z[B]=new Array(R[B].length);for(var q=0;q<z[B].length;q++){var A=u+parseFloat(R[B][q][1])*x,X=P-parseFloat(R[B][q][2])*x;z[B][q]=[A,X]}for(var G=0;G<z[B].length-1;G++)ae.beginPath(),ae.lineWidth=2,ae.moveTo(z[B][G][0],z[B][G][1]),ae.lineTo(z[B][G+1][0],z[B][G+1][1]),ae.strokeStyle=b[2][B],ae.stroke(),ae.closePath();var W=document.createElement("div");W.style.cssText="float:left;width:20px;height:2px;margin:10px 5px;",W.style.backgroundColor=b[2][B];var D=document.createElement("div");D.style.float="left",D.style.color=b[6],D.innerHTML=Q[B],K.appendChild(W),K.appendChild(D)}}1==t?te.addEventListener("mousemove",function(e,t){$.style.display="none",ee.style.display="none",U.style.display="none",Z.style.display="none";var l=oe(e);if(ae.beginPath(),ae.arc(u,P,L,0,2*Math.PI),ae.fillStyle="rgba(0, 0, 0, 0)",ae.fill(),ae.closePath(),ae.isPointInPath(l.x,l.y)){A=(l.x-u)/x,X=(P-l.y)/x,$.style.display="",ee.style.display="",U.style.display="",U.innerHTML='<div style="height: 20px;margin-top: -25px;margin-left: 10px;">'+A.toFixed(3)+","+X.toFixed(3)+"</div>",$.innerHTML='<div  style="height: 1px;background-color: rgba(0, 0, 0, 0);border-top: 1px dashed black ;"></div>',ee.innerHTML='<div  style="width: 1px;background-color: rgba(0, 0, 0, 0);border-left: 1px dashed black ;"></div>';var s=$.childNodes[0],i=ee.childNodes[0],a=2*Math.sqrt(L*L-(l.y-P)*(l.y-P)),o=2*Math.sqrt(L*L-(l.x-u)*(l.x-u)),r=l.x-(u-Math.sqrt(L*L-(l.y-P)*(l.y-P))),n=l.y-(P-Math.sqrt(L*L-(l.x-u)*(l.x-u)));if(U.style.left=l.x+"px",U.style.top=l.y+m+"px",$.style.left=l.x+"px",$.style.top=l.y+m+"px",ee.style.left=l.x+"px",ee.style.top=l.y+m+"px",s.style.width=a+"px",i.style.height=o+"px",s.style.marginLeft=-r+"px",i.style.marginTop=-n+"px","point"==f)for(var d=0;d<I;d++)for(var y=0;y<z[d].length;y++)if(ae.beginPath(),ae.arc(z[d][y][0],z[d][y][1],2,0,2*Math.PI),ae.fillStyle="rgba(0, 0, 0, 0)",ae.fill(),ae.closePath(),ae.isPointInPath(l.x,l.y)){Z.style.display="",Z.innerHTML='<div id="drawPoint" style="width: 8px;height:8px;border-radius: 50%;margin-left: -4px;margin-top: -4px;"></div><div id="valueContent" style="margin: 5px;"><div style="margin: 2px 5px">x:'+[R[d][y][1]]+'</div><div style="margin: 2px 5px">y:'+[R[d][y][2]]+"</div></div>";var h=document.getElementById("drawPoint"),p=document.getElementById("valueContent");h.style.color=b[3],h.style.backgroundColor=b[4][d],p.style.color=b[3],p.style.backgroundColor=b[5],Z.style.left=z[d][y][0]+"px",Z.style.top=z[d][y][1]+m+"px"}}},!1):te.addEventListener("mousemove",function(e,t){$.style.display="none",ee.style.display="none",U.style.display="none",Z.style.display="none";for(var l=oe(e),s=0;s<I;s++)for(var i=0;i<z[s].length;i++)if(ae.beginPath(),ae.arc(z[s][i][0],z[s][i][1],2,0,2*Math.PI),ae.fillStyle="rgba(0, 0, 0, 0)",ae.fill(),ae.closePath(),ae.isPointInPath(l.x,l.y))if("point"==f){Z.style.display="",Z.innerHTML='<div  style="width: 8px;height:8px;border-radius: 50%;margin-left: -4px;margin-top: -4px;"></div><div  style="margin: 10px;border-radius: 5px;"><div style="margin: 2px 5px">x:'+R[s][i][1]+'</div><div style="margin: 2px 5px">y:'+R[s][i][2]+"</div></div>";var a=Z.childNodes[0],o=Z.childNodes[1];a.style.color=b[3],a.style.backgroundColor=b[4][s],o.style.color=b[3],o.style.backgroundColor=b[5],Z.style.left=z[s][i][0]+"px",Z.style.top=z[s][i][1]+m+"px"}else if("cross"==f){$.style.display="",ee.style.display="",U.style.display="",U.innerHTML='<div style="height: 20px;">'+R[s][i][1]+","+R[s][i][2]+"</div>",$.innerHTML='<div   style="height: 1px;background-color: rgba(0, 0, 0, 0);border-top: 1px dashed black ;"></div>',ee.innerHTML='<div  style="width: 1px;background-color: rgba(0, 0, 0, 0);border-left: 1px dashed black ;"></div>';var r=$.childNodes[0],n=ee.childNodes[0],d=2*Math.sqrt(L*L-(z[s][i][1]-P)*(z[s][i][1]-P)),y=2*Math.sqrt(L*L-(z[s][i][0]-u)*(z[s][i][0]-u)),h=z[s][i][0]-(u-Math.sqrt(L*L-(z[s][i][1]-P)*(z[s][i][1]-P))),p=z[s][i][1]-(P-Math.sqrt(L*L-(z[s][i][0]-u)*(z[s][i][0]-u)));if(U.style.left=z[s][i][0]+"px",U.style.top=z[s][i][1]+m+"px",$.style.left=z[s][i][0]+"px",$.style.top=z[s][i][1]+m+"px",ee.style.left=z[s][i][0]+"px",ee.style.top=z[s][i][1]+m+"px",r.style.width=d+"px",n.style.height=y+"px",r.style.marginLeft=-h+"px",n.style.marginTop=-p+"px",V&&O.length){var x=R[s][i][0]/j;!0===_&&(x=R[s][i][0]);var g="("+R[s][i][1].toFixed(2)+","+R[s][i][2].toFixed(2)+"),"+x.toFixed(2)+"GHz";if(Y){var v=R[s][0][0]/j;!0===_&&(v=R[s][0][0]);var c="("+R[s][0][1].toFixed(2)+","+R[s][0][2].toFixed(2)+"),"+v.toFixed(2)+"GHz";Y(g,s,c)}else V.getElementsByClassName("Smith_Msg2")[0].innerText=g}}},!1)},V&&O.length){var d=R[0][0][0]/j;!0===_&&(d=R[0][0][0]);var y="("+R[0][0][1].toFixed(2)+","+R[0][0][2].toFixed(2)+"),"+d.toFixed(2)+"GHz";o?o(y):V.getElementsByClassName("Smith_Msg2")[0].innerText=y}function oe(e){var t,l;return e.layerX||0==e.layerX?(t=e.layerX,l=e.layerY):(e.offsetX||0==e.offsetX)&&(t=e.offsetX,l=e.offsetY),{x:t,y:l}}n.prototype.onresize=function(){te.setAttribute("width",t.offsetWidth),te.setAttribute("height",t.offsetHeight-20),se=te.width,ie=te.height,le=0,h.plot()};var h=new n(i,!1,"cross",!1,["grey","black",a=a||["#1baee1","red"],"white",["#1baee1","red"],"rgba(128, 128, 128, 0.75)","grey","#028BCD"]);return h.onresize(),h}